#include "ldc_inference.h"
#include "model.h"

#ifdef LDC_USE_LUT_LOOKUP
#ifndef LDC_LUT_IN_MEMORY
#define LDC_LUT_MODIFIER const
#else
#ifdef ESP32
#include "esp_attr.h"
#define LDC_LUT_MODIFIER const DRAM_ATTR
#else
#define LDC_LUT_MODIFIER
#endif
#endif
#if LDC_IMPLEMENTATION_LUTBIT == 8 || LDC_IMPLEMENTATION_LUTBIT == 16 || LDC_IMPLEMENTATION_LUTBIT == 32
LDC_LUT_MODIFIER int8_t LUT[] = {
	 8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8
};
#elif LDC_IMPLEMENTATION_LUTBIT == 10
LDC_LUT_MODIFIER int8_t LUT[] = {
	10,  8,  8,  6,  8,  6,  6,  4,  8,  6,  6,  4,  6,  4,  4,  2,  8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,
	 8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,  6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,  6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,  6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,  6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,  0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8,
	 8,  6,  6,  4,  6,  4,  4,  2,  6,  4,  4,  2,  4,  2,  2,  0,  6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,  0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8,
	 6,  4,  4,  2,  4,  2,  2,  0,  4,  2,  2,  0,  2,  0,  0, -2,  4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,  0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8,
	 4,  2,  2,  0,  2,  0,  0, -2,  2,  0,  0, -2,  0, -2, -2, -4,  2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,  0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8,
	 2,  0,  0, -2,  0, -2, -2, -4,  0, -2, -2, -4, -2, -4, -4, -6,  0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8,
	 0, -2, -2, -4, -2, -4, -4, -6, -2, -4, -4, -6, -4, -6, -6, -8, -2, -4, -4, -6, -4, -6, -6, -8, -4, -6, -6, -8, -6, -8, -8, -10,
};
#elif LDC_IMPLEMENTATION_LUTBIT == 11
LDC_LUT_MODIFIER int8_t LUT[] = {
	 11,   9,   9,   7,   9,   7,   7,   5,   9,   7,   7,   5,   7,   5,   5,   3,   9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,
	  9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,   7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,
	  9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,   7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,   7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,   7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,   7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,
	  9,   7,   7,   5,   7,   5,   5,   3,   7,   5,   5,   3,   5,   3,   3,   1,   7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,
	  7,   5,   5,   3,   5,   3,   3,   1,   5,   3,   3,   1,   3,   1,   1,  -1,   5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,
	  5,   3,   3,   1,   3,   1,   1,  -1,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,
	  3,   1,   1,  -1,   1,  -1,  -1,  -3,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,   1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,
	  1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,
	  1,  -1,  -1,  -3,  -1,  -3,  -3,  -5,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,
	 -1,  -3,  -3,  -5,  -3,  -5,  -5,  -7,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,  -3,  -5,  -5,  -7,  -5,  -7,  -7,  -9,  -5,  -7,  -7,  -9,  -7,  -9,  -9, -11,
};
#elif LDC_IMPLEMENTATION_LUTBIT == 12
LDC_LUT_MODIFIER int8_t LUT[] = {
	12,  10,  10,   8,  10,   8,   8,   6,  10,   8,   8,   6,   8,   6,   6,   4,  10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	10,   8,   8,   6,   8,   6,   6,   4,   8,   6,   6,   4,   6,   4,   4,   2,   8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	8,   6,   6,   4,   6,   4,   4,   2,   6,   4,   4,   2,   4,   2,   2,   0,   6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	6,   4,   4,   2,   4,   2,   2,   0,   4,   2,   2,   0,   2,   0,   0,  -2,   4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	4,   2,   2,   0,   2,   0,   0,  -2,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	2,   0,   0,  -2,   0,  -2,  -2,  -4,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,   0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	0,  -2,  -2,  -4,  -2,  -4,  -4,  -6,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10, 
	-2,  -4,  -4,  -6,  -4,  -6,  -6,  -8,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10,  -4,  -6,  -6,  -8,  -6,  -8,  -8, -10,  -6,  -8,  -8, -10,  -8, -10, -10, -12,
};
#endif
#endif

#ifdef LDC_IMPLEMENTATION_UNROLL
#define _LOAD_VAR(var, i) LDC_MODEL_DTYPE var##i = *c++;
#define _SET_ARR_I_TO_VF_XOR_C_I(arr, i) arr[i] += lookup(vf ^ c##i);
#define _SET_VAR_TO_V_XOR_F_XOR_C_I(var, i) var += lookup(v_val ^ *f_ptr++ ^ c##i);

#define _INST1(INST, arg) INST(arg, 0)
#define _INST2(INST, arg) _INST1(INST, arg) INST(arg, 1)
#define _INST3(INST, arg) _INST2(INST, arg) INST(arg, 2)
#define _INST4(INST, arg) _INST3(INST, arg) INST(arg, 3)
#define _INST5(INST, arg) _INST4(INST, arg) INST(arg, 4)
#define _INST6(INST, arg) _INST5(INST, arg) INST(arg, 5)
#define _INST7(INST, arg) _INST6(INST, arg) INST(arg, 6)
#define _INST8(INST, arg) _INST7(INST, arg) INST(arg, 7)
#define _INST9(INST, arg) _INST8(INST, arg) INST(arg, 8)
#define _INST10(INST, arg) _INST9(INST, arg) INST(arg, 9)
#define _INST11(INST, arg) _INST10(INST, arg) INST(arg, 10)
#define _INST12(INST, arg) _INST11(INST, arg) INST(arg, 11)
#define _INST13(INST, arg) _INST12(INST, arg) INST(arg, 12)
#define _INST14(INST, arg) _INST13(INST, arg) INST(arg, 13)
#define _INST15(INST, arg) _INST14(INST, arg) INST(arg, 14)
#define _INST16(INST, arg) _INST15(INST, arg) INST(arg, 15)
#define LOOP(N, INST, ARG) _INST##N(INST, ARG)

#define LOAD_VAR(ARG, N) LOOP(N, _LOAD_VAR, ARG)
#define SET_ARR_I_TO_VF_XOR_C_I(ARG, N) LOOP(N, _SET_ARR_I_TO_VF_XOR_C_I, ARG)
#define SET_VAR_TO_V_XOR_F_XOR_C_I(ARG, N) LOOP(N, _SET_VAR_TO_V_XOR_F_XOR_C_I, ARG)
#endif

uint8_t argmax(LDC_MODEL_ACC_DTYPE* arr, uint8_t len)
{
	uint8_t i;
	uint8_t maxIndex = 0;
	LDC_MODEL_ACC_DTYPE max = arr[0];
	for (i=1; i<len; i++)
	{
		if (arr[i] > max)
		{
			maxIndex = i;
			max = arr[i];
		}
	}
	return maxIndex;
}

LDC_MODEL_LUT_RET_DTYPE lookup(LDC_MODEL_DTYPE v) {
#if defined(LDC_USE_LUT_LOOKUP) && (LDC_IMPLEMENTATION_LUTBIT == 8 || LDC_IMPLEMENTATION_LUTBIT == 10 || LDC_IMPLEMENTATION_LUTBIT == 12)
	return LUT[v];
#elif defined(LDC_USE_LUT_LOOKUP) && LDC_IMPLEMENTATION_LUTBIT == 11
	// all LUT result will be greater than the actual result by 1 which doesn't affect classification result as we only interested in relative value between class
	return LUT[v & 0x000007FF] + LUT[(v >> 11) & 0x000007FF] + LUT[(v >> 22) & 0x000007FF];
#elif defined(LDC_USE_LUT_LOOKUP) && LDC_IMPLEMENTATION_LUTBIT == 16
	return LUT[v & 0xFF] + LUT[v >> 8];
#elif defined(LDC_USE_LUT_LOOKUP) && LDC_IMPLEMENTATION_LUTBIT == 32
    return LUT[v & 0xFF] + LUT[(v >> 8) & 0xFF] + LUT[(v >> 16) & 0xFF] + LUT[v >> 24];
#elif !defined(LDC_USE_LUT_LOOKUP) && LDC_IMPLEMENTATION_LUTBIT == 32
	// From: https://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel
	v = v - ((v >> 1) & 0x55555555);
	v = (v & 0x33333333) + ((v >> 2) & 0x33333333);
	LDC_MODEL_LUT_RET_DTYPE count = ((v + (v >> 4) & 0xF0F0F0F) * 0x1010101) >> 24;
	return 32 - (count * 2);
//    return 32 - (__builtin_popcount(v) * 2);
#else
#error Unsupport look up configuration
#endif
}

uint8_t ldc_inference_block(const uint8_t in[], const uint16_t in_length
#ifndef LDC_IMPLEMENTATION_FIX_SIZE
							, const LDC_MODEL_DTYPE* restrict f, const LDC_MODEL_DTYPE* restrict v, const LDC_MODEL_DTYPE* restrict c
							, uint8_t num_class, uint16_t num_feature, uint8_t fhv_dim_word
#endif
#ifdef LDC_IMPLEMENTATION_DEBUG_P
                            , LDC_MODEL_ACC_DTYPE* debugP
#endif
							)
{
#ifdef LDC_IMPLEMENTATION_FIX_SIZE && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	const LDC_MODEL_DTYPE* restrict f = LDC_MODEL_F;
	const LDC_MODEL_DTYPE* restrict v = LDC_MODEL_V;
	const LDC_MODEL_DTYPE* restrict c = LDC_MODEL_C;
	const uint8_t num_class = LDC_MODEL_NUM_CLASS;
	const uint16_t num_feature = LDC_MODEL_NUM_FEATURE;
	const uint8_t fhv_dim_word = LDC_MODEL_FHV_DIMENSION_WORD;
#endif

	uint16_t i;
	uint8_t j, k, m;
    int8_t l;
	LDC_MODEL_ACC_DTYPE p[LDC_MAX_NUM_CLASS] = {0};
#if LDC_IMPLEMENTATION == 0 && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_F
	LDC_MODEL_DTYPE s[LDC_MAX_FHV_DIM] = {0};
	LDC_MODEL_ACC_DTYPE t[LDC_IMPLEMENTATION_NUMBIT] = {0};
	for (j=0; j<fhv_dim_word; j++)
	{
		for(l=0; l<LDC_IMPLEMENTATION_NUMBIT; l++)
		{
			t[l] = 0;
		}
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE vf = v[in[i]] ^ f[j * num_feature + i];
			for(l=LDC_IMPLEMENTATION_NUMBIT-1; l>=0; l--)
			{
				t[l] += vf & 1;	// t[l] += ((vf & 1) == 0) ? 1 : -1;
				vf = vf >> 1;
			}
		}
		for(l=0; l<LDC_IMPLEMENTATION_NUMBIT; l++)
		{
			s[j] = s[j] << 1;
			s[j] |= ((t[l] > LDC_MODEL_NUM_FEATURE / 2) ? 1 : 0); 	// 0 => 1, 1 => -1   // ((t[l] >= 0) ? 0 : 1)
		}
	}
	for (k=0; k<num_class; k++)
	{
		for (j=0; j<fhv_dim_word; j++)
		{
			p[k] += lookup(s[j] ^ c[k*fhv_dim_word + j]);
		}
	}
#elif LDC_IMPLEMENTATION == 0 && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_F
	LDC_MODEL_DTYPE s[LDC_MAX_FHV_DIM] = {0};
	LDC_MODEL_ACC_DTYPE t[LDC_IMPLEMENTATION_NUMBIT] = {0};
    LDC_MODEL_DTYPE partial_t[LDC_IMPLEMENTATION_NUMBIT] = {0};
	for (j=0; j<fhv_dim_word; j++)
	{
        const uint8_t* restrict in_ptr = in;
		for(l=0; l<LDC_IMPLEMENTATION_NUMBIT; l++)
		{
			t[l] = 0;
		}
		for (m=0; m<num_feature/64; m++)
		{
            for (k=0; k<64; k++)
            {
                LDC_MODEL_DTYPE vf = v[*in_ptr++] ^ *f++;
                for(l=LDC_IMPLEMENTATION_NUMBIT-1; l>=0; l--)
                {
                    partial_t[l] += vf & 1;	// t[l] += ((vf & 1) == 0) ? 1 : -1;
                    vf = vf >> 1;
                }
            }
			for(l=0; l<LDC_IMPLEMENTATION_NUMBIT; l++)
            {
                t[l] += partial_t[l];
                partial_t[l] = 0;
            }
		}
        if (num_feature%64 != 0)
        {
            for (k=0; k<num_feature%64; k++)
            {
                LDC_MODEL_DTYPE vf = v[*in_ptr++] ^ *f++;
                for(l=LDC_IMPLEMENTATION_NUMBIT-1; l>=0; l--)
                {
                    partial_t[l] += vf & 1;	// t[l] += ((vf & 1) == 0) ? 1 : -1;
                    vf = vf >> 1;
                }
            }
			for(l=0; l<LDC_IMPLEMENTATION_NUMBIT; l++)
            {
                t[l] += partial_t[l];
                partial_t[l] = 0;
            }
        }
		for(l=0; l<LDC_IMPLEMENTATION_NUMBIT; l++)
		{
			s[j] = s[j] << 1;
			s[j] |= ((t[l] > LDC_MODEL_NUM_FEATURE / 2) ? 1 : 0); 	// 0 => 1, 1 => -1   // ((t[l] >= 0) ? 0 : 1)
		}
	}
	for (k=0; k<num_class; k++)
	{
		for (j=0; j<fhv_dim_word; j++)
		{
			p[k] += lookup(s[j] ^ c[k*fhv_dim_word + j]);
		}
	}
#elif LDC_IMPLEMENTATION == 1 && !defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM)
	for (j=0; j<fhv_dim_word; j++)
	{
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE vf = v[in[i]] ^ f[i * fhv_dim_word + j];
			for (k=0; k<num_class; k++)
			{
				LDC_MODEL_DTYPE vfc = vf ^ c[k * fhv_dim_word + j];
				p[k] += lookup(vfc);
			}

		}
	}
#elif LDC_IMPLEMENTATION == 1 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && !defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_UNROLL) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	#define NEED_MODEL_TRANSPOSE_F
	for (j=0; j<fhv_dim_word; j++)
	{
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE vf = v[in[i]] ^ f[j * num_feature + i];
			for (k=0; k<num_class; k++)
			{
				LDC_MODEL_DTYPE vfc = vf ^ c[j * num_class + k];
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 1 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_UNROLL) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	#define NEED_MODEL_TRANSPOSE_F
	for (j=0; j<fhv_dim_word; j++)
	{
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE vf = v[in[i]] ^ *f++;
			for (k=0; k<num_class; k++)
			{
				LDC_MODEL_DTYPE vfc = vf ^ c[k];
				p[k] += lookup(vfc);
			}
		}
		c += num_class;
	}
#elif LDC_IMPLEMENTATION == 1 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && !defined(LDC_IMPLEMENTATION_UNROLL) && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	#define NEED_MODEL_TRANSPOSE_F
	int8_t tmp[LDC_MAX_NUM_CLASS] = {0};
	for (j=0; j<fhv_dim_word; j++)
	{
		const uint8_t* restrict in_ptr = in;
		for (i=0; i<num_feature/16; i++)
		{
			for (l=0; l<16; l++)
			{
				LDC_MODEL_DTYPE vf = v[*in_ptr++] ^ *f++;
				for (k=0; k<num_class; k++)
				{
					tmp[k] += lookup(vf ^ c[k]);
				}
			}
			for (l=0; l<LDC_MAX_NUM_CLASS; l++)
			{
				p[l] += tmp[l];
				tmp[l] = 0;
			}
		}
        if ((num_feature % 16) != 0)
        {
            for (l=0; l<num_feature%16; l++)
            {
                LDC_MODEL_DTYPE vf = v[*in_ptr++] ^ *f++;
                for (k=0; k<num_class; k++)
                {
                    tmp[k] += lookup(vf ^ c[k]);
                }
            }
            for (l=0; l<LDC_MAX_NUM_CLASS; l++)
            {
                p[l] += tmp[l];
                tmp[l] = 0;
            }
        }
		c += num_class;
	}
#elif LDC_IMPLEMENTATION == 1 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_UNROLL) && defined(LDC_IMPLEMENTATION_FIX_SIZE) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	#define NEED_MODEL_TRANSPOSE_F
	for (j=0; j<fhv_dim_word; j++)
	{
		LOAD_VAR(c, LDC_MODEL_NUM_CLASS)
        for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE vf = v[in[i]] ^ *f++;
			SET_ARR_I_TO_VF_XOR_C_I(p, LDC_MODEL_NUM_CLASS)
		}
	}
#elif LDC_IMPLEMENTATION == 1 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_UNROLL) && defined(LDC_IMPLEMENTATION_FIX_SIZE) && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	#define NEED_MODEL_TRANSPOSE_F
    int8_t tmp[LDC_MAX_NUM_CLASS]= {0};
	for (j=0; j<fhv_dim_word; j++)
	{
		LOAD_VAR(c, LDC_MODEL_NUM_CLASS)
        const uint8_t* restrict in_ptr = in;
        for (k=0; k<num_feature/16; k++)
        {
            for (l=0; l<16; l++)
            {
                LDC_MODEL_DTYPE vf = v[*in_ptr++] ^ *f++;
                SET_ARR_I_TO_VF_XOR_C_I(tmp, LDC_MODEL_NUM_CLASS)
            }
            for (l=0; l<LDC_MAX_NUM_CLASS; l++)
            {
                p[l] += tmp[l];
                tmp[l] = 0;
            }
        }
        if ((num_feature%16) != 0)
        {
            for (l=0; l<num_feature%16; l++)
            {
                LDC_MODEL_DTYPE vf = v[*in_ptr++] ^ *f++;
                SET_ARR_I_TO_VF_XOR_C_I(tmp, LDC_MODEL_NUM_CLASS)
            }
            for (l=0; l<LDC_MAX_NUM_CLASS; l++)
            {
                p[l] += tmp[l];
                tmp[l] = 0;
            }
        }
	}
#elif LDC_IMPLEMENTATION == 2 && !defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM)
	for (i=0; i<num_feature; i++)
	{
		const LDC_MODEL_DTYPE v_val = v[in[i]];
		for (j=0; j<fhv_dim_word; j++)
		{
			const LDC_MODEL_DTYPE vf = v_val ^ *f++;
			for (k=0; k<num_class; k++)
			{
				const LDC_MODEL_DTYPE vfc = vf ^ c[k * fhv_dim_word + j];
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 2 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && !defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	for (i=0; i<num_feature; i++)
	{
		LDC_MODEL_DTYPE v_val = v[in[i]];
		for (j=0; j<fhv_dim_word; j++)
		{
			LDC_MODEL_DTYPE vf = v_val ^ f[i * fhv_dim_word + j];
			for (k=0; k<num_class; k++)
			{
				LDC_MODEL_DTYPE vfc = vf ^ c[j * num_class + k];
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 2 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
	for (i=0; i<num_feature; i++)
	{
		const LDC_MODEL_DTYPE v_val = v[*in++];
		const LDC_MODEL_DTYPE* restrict c_ptr = c;
		for (j=0; j<fhv_dim_word; j++)
		{
			const LDC_MODEL_DTYPE vf = v_val ^ *f++;
			for (k=0; k<num_class; k++)
			{
				const LDC_MODEL_DTYPE vfc = vf ^ *c_ptr++;
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 2 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	#define NEED_MODEL_TRANSPOSE_C
    int8_t tmp[LDC_MAX_NUM_CLASS]= {0};
	for (i=0; i<num_feature; i++)
	{
		const LDC_MODEL_DTYPE v_val = v[*in++];
		const LDC_MODEL_DTYPE* restrict c_ptr = c;
		for (j=0; j<fhv_dim_word; j++)
		{
			const LDC_MODEL_DTYPE vf = v_val ^ *f++;
			for (k=0; k<num_class; k++)
			{
				const LDC_MODEL_DTYPE vfc = vf ^ *c_ptr++;
				tmp[k] += lookup(vfc);
			}
		}
        for (l=0; l<LDC_MAX_NUM_CLASS; l++)
        {
            p[l] += tmp[l];
            tmp[l] = 0;
        }
	}
#elif LDC_IMPLEMENTATION == 3 && !defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_UNROLL) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	for (k=0; k<num_class; k++)
	{
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE v_val = v[in[i]];
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = v_val ^ f[(i * fhv_dim_word) + j] ^ c[(k * fhv_dim_word) + j];
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 3 && defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_UNROLL) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	for (k=0; k<num_class; k++)
	{
		const LDC_MODEL_DTYPE* restrict f_ptr = f;
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE v_val = v[in[i]];
			const LDC_MODEL_DTYPE* restrict c_ptr = &c[k * fhv_dim_word];
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = v_val ^ *f_ptr++ ^ *c_ptr++;
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 3 && defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_UNROLL) && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	for (k=0; k<num_class; k++)
	{
		const LDC_MODEL_DTYPE* f_ptr = f;
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE v_val = v[in[i]];
			const LDC_MODEL_DTYPE* restrict c_ptr = &c[k * fhv_dim_word];
			int8_t tmp = 0;
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = v_val ^ *f_ptr++ ^ *c_ptr++;
				tmp += lookup(vfc);
			}
			p[k] += tmp;
		}
	}
#elif LDC_IMPLEMENTATION == 3 && defined(LDC_IMPLEMENTATION_UNROLL) && defined(LDC_IMPLEMENTATION_FIX_SIZE) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	for (k=0; k<num_class; k++)
	{
		LOAD_VAR(c, LDC_MODEL_FHV_DIMENSION_WORD)

		const LDC_MODEL_DTYPE* restrict f_ptr = f;
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE v_val = v[in[i]];
			SET_VAR_TO_V_XOR_F_XOR_C_I(p[k], LDC_MODEL_FHV_DIMENSION_WORD)
		}
	}
#elif LDC_IMPLEMENTATION == 3 && defined(LDC_IMPLEMENTATION_UNROLL) && defined(LDC_IMPLEMENTATION_FIX_SIZE) && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	for (k=0; k<num_class; k++)
	{
		LOAD_VAR(c, LDC_MODEL_FHV_DIMENSION_WORD)

		const LDC_MODEL_DTYPE* restrict f_ptr = f;
		for (i=0; i<num_feature; i++)
		{
			LDC_MODEL_DTYPE v_val = v[in[i]];

			int8_t tmp = 0;
			SET_VAR_TO_V_XOR_F_XOR_C_I(tmp, LDC_MODEL_FHV_DIMENSION_WORD)
			p[k] += tmp;
		}
	}
#elif LDC_IMPLEMENTATION == 4 && !defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM)
	for (i=0; i<num_feature; i++)
	{
		LDC_MODEL_DTYPE v_val = v[in[i]];
		for (k=0; k<num_class; k++)
		{
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = v_val ^ f[(i * fhv_dim_word) + j] ^ c[(k * fhv_dim_word) + j];
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 4 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && !defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	LDC_MODEL_DTYPE t[LDC_MAX_FHV_DIM] = {0};
	for (i=0; i<num_feature; i++)
	{
		const LDC_MODEL_DTYPE v_val = v[in[i]];
		for (j=0; j<fhv_dim_word; j++)
		{
			t[j] = v_val ^ f[(i * fhv_dim_word) + j];
		}
		for (k=0; k<num_class; k++)
		{
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = t[j] ^ c[k * fhv_dim_word + j];
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 4 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_POINTERIZE) && !defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	LDC_MODEL_DTYPE t[LDC_MAX_FHV_DIM] = {0};
	for (i=0; i<num_feature; i++)
	{
		LDC_MODEL_DTYPE v_val = v[in[i]];
		for (j=0; j<fhv_dim_word; j++)
		{
			t[j] = v_val ^ *f++;
		}
		const LDC_MODEL_DTYPE* restrict c_ptr = c;
		for (k=0; k<num_class; k++)
		{
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = t[j] ^ *c_ptr++;
				p[k] += lookup(vfc);
			}
		}
	}
#elif LDC_IMPLEMENTATION == 4 && defined(LDC_IMPLEMENTATION_OPTIMIZE_MEM) && defined(LDC_IMPLEMENTATION_FLAVOR_8BITADD)
	LDC_MODEL_DTYPE t[LDC_MAX_FHV_DIM] = {0};
	for (i=0; i<num_feature; i++)
	{
		LDC_MODEL_DTYPE v_val = v[*in++];
		for (j=0; j<fhv_dim_word; j++)
		{
			t[j] = v_val ^ *f++;
		}
		const LDC_MODEL_DTYPE* restrict c_ptr = c;
		for (k=0; k<num_class; k++)
		{
			int8_t tmp = 0;
			for (j=0; j<fhv_dim_word; j++)
			{
				LDC_MODEL_DTYPE vfc = t[j] ^ *c_ptr++;
				tmp += lookup(vfc);
			}
			p[k] += tmp;
		}
	}
#else
#error LDC Implementation not found!!! Please check the value of LDC_IMPLEMENTATION.
#endif
#ifdef LDC_IMPLEMENTATION_DEBUG_P
    for (j=0; j<num_class; j++)
    {
        debugP[j] = p[j];
    }
#endif
	return argmax(p, num_class);
}

#if defined(NEED_MODEL_TRANSPOSE_C) && !defined(MODEL_TRANSPOSE_C)
	#error The C vector of the LDC model need to be transpose
#endif
#if !defined(NEED_MODEL_TRANSPOSE_C) && defined(MODEL_TRANSPOSE_C)
	#error The C vector of the LDC model must not be transpose
#endif
#if defined(NEED_MODEL_TRANSPOSE_F) && !defined(MODEL_TRANSPOSE_F)
	#error The F vector of the LDC model need to be transpose
#endif
#if !defined(NEED_MODEL_TRANSPOSE_F) && defined(MODEL_TRANSPOSE_F)
	#error The F vector of the LDC model must not be transpose
#endif
